<!DOCTYPE html>
<html>
<head>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.1.0/mapbox-gl-compare.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.1.0/mapbox-gl-compare.css' type='text/css' />
    <style>
        h2 {color: rgba(62, 62, 62, 0.98);
            background-color: #f8ffff;
            opacity: 0.95;
            width: fit-content;
            width:-moz-fit-content;
        }
        ol{
            background-color: #d9fffc;
            opacity: 0.95;
            width: fit-content;
            width:-moz-fit-content;
            max-height: fit-content;
        }
        p {
            background-color: #d9fffc;
            opacity: 0.95;
            width: fit-content;
            width: -moz-fit-content;
            max-height: fit-content;
        }
        body { margin:25px;}
        body * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        #map { position:absolute; top:0; bottom:0; padding: 5px; width:100%; }
        #menu {
            background: #fff;
            margin-top: 20px;
            width: fit-content;
            width: -moz-fit-content;
            border: 1px solid rgba(0,0,0,0.4);
            font-family: "Segoe UI",sans-serif;
        }

        #menu a {
            font-size: 13px;
            color: #404040;
            display: block;
            padding: 10px;
            text-decoration: none;
            border-bottom: 1px solid rgba(0,0,0,0.25);
            text-align: center;
        }

        #menu a:last-child {
            border: none;
        }

        #menu a:hover {
            background-color: #f8f8f8;
            color: #404040;
        }

        #menu a.active {
            background-color: #3887be;
            color: #ffffff;
        }

        #menu a.active:hover {
            background: #3074a4;
        }
        .map-overlay {
            position: relative;
            bottom: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.8);
            margin-right: 20px;
            font-family: "Segoe UI",sans-serif;
            overflow: auto;
            border-radius: 3px;
        }

        #legend {
            top: 0;
            left: 0;
            position: absolute;
            padding: 10px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            line-height: 18px;
            margin-bottom: 40px;
            width: fit-content;
            z-index: 10;
        }
        #legend2{
            top: 0;
            left: 0;
            position: absolute;
            padding: 10px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            line-height: 18px;
            margin-bottom: 40px;
            width: fit-content;
            z-index: 10;
        }

        .legend-key {
            display: inline-block;
            float: left;
            border-radius: 20%;
            width: 15px;
            height: 15px;
            margin-right: 5px;
        }

        .mapboxgl-popup {
            max-width: 400px;
            font: 12px/20px "Segoe UI", Arial, Helvetica, sans-serif;
        }



    </style>

</head>

<body>

<h1 style="color: white; background-color: black; text-align: center">Assignment 4 - Group 17</h1>
<h1>Motivation</h1>
<p>In this assignment we wish to visualise some <a href="//www.kaggle.com/c/sf-crime/data">crime classification data for San Franscisco</a>
    from 2000 onwards. <br />We were also provided a dataset underlining the area of the
    <a href="//wouterboomsma.github.io/ide2017/assignments/assignment5/sfpd_districts.geojson">Northern police district</a>
    which we will use in our analysis.
</p>

<h1>Methodology</h1>
For this assignment we used the web-ready visualization tool <a href = "//www.mapbox.com/">mapbox</a>.
It requires a user account in which you can upload your datafile. <br />
By following the instructions for using the data visualisation tools of
mapbox we obtain an access token and style key that are used to create the visualisation and make the code work. For more
on that, see: <a href="//www.mapbox.com/help/define-access-token/">here</a>
<a href="//www.mapbox.com/help/define-style-url/">and here</a><br /><br />

We make two maps that show differnt variables and place them side-by-side to compare.
<br />
In the first map, to provide a contrasting background against the bright colors we'll be seeing, we use a black-themed background.
<br />
For the second one, we use a regular street-map to see the black and white dots better than we would in lighter- or darker-colored
maps(<a href="//www.mapbox.com/mapbox-gl-js/example/setstyle/">see here</a>)
<br />
We show the map coordinates of where the cursor falls(scroll down) and the outline of the Northern police district on both maps.
<br /><br />
In the first map we provide the following information:
<ol>
    <li>Different colors for different days of the week and</li>
    <li>different colors for different crime types(see legend)</li>
</ol>
Note: Though the two visualisations can overlap, they need to be manually toggled off to look at them individually. <br />
When the button color is blue it means the map is in effect, whereas when the color is white it's not in effect. <br />
However, the circles for the two have different sizes and a tooltip has been added to aid in performing simultaneous analysis, if need be.
<br /><br />

For the second map we show the variable that shows the resolution(or not) of the offence. Most successful resolutions('ARREST, CITED',
'ARREST, BOOKED' and LOCATED - referring to missing persons) were grouped under success, whereas cases with no resolution(NONE) were grouped under "No resolution".<br /> Finally, crimes classified as "Psychopathic cases"
were grouped independently.



<h1>Results</h1>


<div id='features'><h2>Crime in San Francisco</h2><div id='pd'><p>Click a button to choose a dataset <br />or hover over the map for the coordinates!</p></div></div>
<div  id="menu"></div>

<div id='map1' class='map' style='width: 500px; height: 500px; float: left'>
    <div style="background-color: white" id='legend'></div>
</div>
<div id='map2' class='map' style='width: 500px; height: 500px'>
    <div style="background-color: white" id='legend2'></div>
</div>

<div><h2>Coordinates</h2><div id='info'>

    <p>
        {"x":   ,"y":   }<br />
        {"lng":   ,"lat":   }

    </p>

</div></div>

<h1>Discussion and analysis</h1>

<p>Looking at map 1 it is immediately interesting to note the uniformity of the datapoints on the map, both for the days of the week
    and the crime categories. <br />This means several things. First of all, it means that more crimes than we expected are commited on weekends than one weould expect if
    the probabilities were equal because the orange dots aren't that greatly outnumbered in the map. Second of all, this means that there are no
    areas where a crime type clusters(is more frequent) or an area with higher crime-rate on weekends or week days, save for outliers on the outskirts of the
    total area we're studying. When looking at the crime types we can easily see that larceny and burglary cases are the most common of all the identified categories, and again, they don't seem
    to cluster around any specific area.
    <br />
    When comparing the data for the northern district we can see that it has significantly less cases of any crime type compared to other districts, given it's size.
    <br />
    This observation is largely due to the fact that there are very few crimes happening in the area comprising the university of San Francisco, where, instead, in the northern part of the district we find the most cases reported in it.
    Numerically speaking, it's the Mission District and Southern District that have the most cases, with 1901 and 1819 respectively, but geographically speaking, the
    most crimes appear in the area north of the Northern district and by the south-west of Chinatown, in Tenderloin. The district with the less cases reported has been the Richmond District with only 513 cases.
    In general, University campuses and parks show the less crime.
    <br />

    From the second map, we can see that the unsolved cases outnumber the solved ones(5958 to 4047) and that the, usually non-criminal, 188 psychopathic cases are evenly laid out throughout the city.
</p>

<h1>Conclusions</h1>

<p>In conclusion, looking at the geographic spread of the crime data we can say that there doesn't appear to be an apparent increase in the crime frequency
    of any type of crime on the weekends or weekdays or any important crime type clustering around any specific area in San Francisco. That does not mean, however, that
    there aren't areas with more or less crime and depending on the district, the number of cases they work with differs a lot, from 513 in Richmond to 1900 in Mission.
    The northern district in particular seems to be split in half, with the southern part that lies within the San Francisco University having very few reported crimes and the
    northern part that's close to Tenderloin having the bulk of the crimes that occupy the district police officers. Having said that, The Tenderloin area seems
    to have the highest density of crimes from all other areas with parks, golf-courses and universities having the lowest crime density, i.e being the safest.

</p>

<h1>Possible improvements</h1>

<h1>Possible improvements</h1>
<P>There are several improvements that can, or should, be made to the above data and analysis.<br />First of all, the data can be further analysed with a text editor to extract other useful information, <br />
    such as crime-count per area and or district. Second of all, the data can be visualised in different ways, by using a barplot, boxplot, line plot or even a table to try to detect among the variables variables, such as the year and the crime-count of a specific crime category, etc.
    <br /> Lastly, the same mapbox could be used to plot the data on it differently. We suggest anything from a time transition of crime counts, to a point-count map, to a heatmap on top of the geographical map and a histogram of the number of crimes and resolution tags in each district <br />
    That way we could analyse the performance of each district. If we want to study crime types instead, we can do a histogram of all crime types on a specific day or against the resolution tags.
    <br />
    It would also be interesting, for example,
    to see if the number of unresolved cases remain the same or if it increases, which could suggest that older cases are eventually solved, <br /> and not that there is
    necessarily a high number of cases that goes unsolved. On top of that, it would be interesting to see analyse the probability that a case will go unsolved depending on the crime type.

</P>

<script>

    //setup  mapbox
    mapboxgl.accessToken = 'pk.eyJ1IjoiZWxtaXJhY2xlIiwiYSI6ImNqYnRzMHZvaDF1OTYyeG05ODYzeG0xcjMifQ.46vT-JIIIOygrEn8SOZr1g';
    var beforemap = new mapboxgl.Map({
        container: 'map1',
        style: 'mapbox://styles/mapbox/dark-v9',
        center: [-122.427489,37.767831],
        zoom: 11.38

    });
    beforemap.on('load', function() {


        //add the outline of the northern district
        beforemap.addLayer({
            'id': 'northern',
            'type': 'fill',
            'source': {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'geometry': {
                        "type":"MultiPolygon",
                        "coordinates":[[[[-122.44665,37.775876],
                            [-122.446825,37.776718],[-122.447014,37.777647],[-122.447207,37.778601],[-122.447484,37.78], [-122.447518,37.780132],[-122.447553,37.780283],
                            [-122.447699,37.781039],[-122.447712,37.781118],[-122.447745,37.781279],[-122.447762,37.781365],
                            [-122.448049,37.78237],[-122.448044,37.782377], [-122.447194,37.782659],[-122.446008,37.782807],
                            [-122.445875,37.782746],[-122.445742,37.782684], [-122.444473,37.782848],[-122.442826,37.783056], [-122.441179,37.783267],[-122.439563,37.783474],
                            [-122.439468,37.783485],[-122.439023,37.783543], [-122.43886,37.78359],[-122.438737,37.783643],
                            [-122.438599,37.783709],[-122.438483,37.78376], [-122.438347,37.783809],[-122.438201,37.783853],
                            [-122.438093,37.783879],[-122.438004,37.783896], [-122.437888,37.783906],[-122.43777,37.783915],
                            [-122.435544,37.7842],[-122.434777,37.784333], [-122.434715,37.784128],[-122.434613,37.783786],
                            [-122.434466,37.783058],[-122.434298,37.782229], [-122.434261,37.782043],[-122.434109,37.781297],
                            [-122.434072,37.78111],[-122.433921,37.780365],[-122.433902,37.780272],[-122.433883,37.780178],
                            [-122.433733,37.779434],[-122.433695,37.779246],[-122.433543,37.778501], [-122.433505,37.778313],[-122.433355,37.777569],[-122.433336,37.777475],
                            [-122.433318,37.777382],[-122.433145,37.776534],[-122.432978,37.775704],[-122.43296,37.775609],[-122.432942,37.775517],[-122.432772,37.774675],
                            [-122.432754,37.774583],[-122.432604,37.773838],[-122.432416,37.772908], [-122.432398,37.772813],[-122.432379,37.77272],[-122.432229,37.771974],
                            [-122.432041,37.771044],[-122.432022,37.77095],[-122.432002,37.770855],[-122.431929,37.770491],[-122.431834,37.77002],[-122.431713,37.769414], [-122.431568,37.769307],[-122.431486,37.769211],[-122.431333,37.767602],
                            [-122.431187,37.766073],[-122.43127,37.765887],[-122.432985,37.764537], [-122.433252,37.764337],[-122.433443,37.764179],[-122.433537,37.7641],
                            [-122.434952,37.762981],[-122.435034,37.762915],[-122.435203,37.762857], [-122.435338,37.762819],[-122.435539,37.762733],[-122.435778,37.762629],
                            [-122.436029,37.762521],[-122.436355,37.762217],[-122.436408,37.762195], [-122.43647,37.762174],[-122.436529,37.762157],[-122.436601,37.76214],
                            [-122.436887,37.762088],[-122.437201,37.76203],[-122.437306,37.762013], [-122.437419,37.761995],[-122.438272,37.761847],[-122.438374,37.76183],[-122.438477,37.761813],
                            [-122.438591,37.761793],[-122.438705,37.761769],[-122.438797,37.761749],[-122.438976,37.761704],
                            [-122.439096,37.761669],[-122.439117,37.761662],[-122.439176,37.761643],[-122.439325,37.761593],
                            [-122.439426,37.761556],[-122.439527,37.76152],[-122.439623,37.76148],[-122.439703,37.761444],
                            [-122.439847,37.761376],[-122.439977,37.761307],[-122.440076,37.761257],[-122.440176,37.761206],
                            [-122.440541,37.761179],[-122.440906,37.761178],[-122.440994,37.761177],[-122.441793,37.761175],
                            [-122.442249,37.761175],[-122.442356,37.761175],[-122.442446,37.761174],[-122.442734,37.760983],
                            [-122.442976,37.760865],[-122.443506,37.760642],[-122.444031,37.760304],[-122.444235,37.760173],
                            [-122.444388,37.760075],[-122.444566,37.75996],[-122.44472,37.75986],[-122.444814,37.759799],
                            [-122.444856,37.759765],[-122.444885,37.759738],[-122.444918,37.759703],[-122.444946,37.75967],
                            [-122.444965,37.759642],[-122.444983,37.759611],[-122.445016,37.759539],[-122.445026,37.759509],
                            [-122.445035,37.759471],[-122.445066,37.759383],[-122.445075,37.759339],[-122.445081,37.759301],
                            [-122.445085,37.759244],[-122.445087,37.7592],[-122.445085,37.759157],[-122.44508,37.759114],
                            [-122.445061,37.759019],[-122.445047,37.758968],[-122.445023,37.758906],[-122.445009,37.758875],
                            [-122.444973,37.758809],[-122.444919,37.758729],[-122.444865,37.758664],[-122.444864,37.758601],
                            [-122.444672,37.758461],[-122.44459,37.758272],[-122.444558,37.758263],[-122.444276,37.75821],
                            [-122.443996,37.758076],[-122.443687,37.757938],[-122.44345,37.757762],[-122.443255,37.757545],
                            [-122.443195,37.757488],[-122.443038,37.757339],[-122.443011,37.757305],[-122.442875,37.757139],
                            [-122.442755,37.757001],[-122.442705,37.756946],[-122.442648,37.756865],[-122.442625,37.756832],
                            [-122.442584,37.756787],[-122.442552,37.756755],[-122.442526,37.756733],[-122.442489,37.756703],
                            [-122.442449,37.756676],[-122.442378,37.756634],[-122.442312,37.756603],[-122.442273,37.756575],
                            [-122.442234,37.756546],[-122.441457,37.756322],[-122.441452,37.756325],[-122.441421,37.756317],
                            [-122.441386,37.756303],[-122.441359,37.756286],[-122.441356,37.756279],[-122.441321,37.756202],
                            [-122.441276,37.756097],[-122.441325,37.755881],[-122.441449,37.75559],[-122.44147,37.75557],
                            [-122.44151,37.755529],[-122.441571,37.755449],[-122.441593,37.755411],[-122.441609,37.755381],
                            [-122.441624,37.755346],[-122.441637,37.755313],[-122.441637,37.755306],[-122.441639,37.755294],
                            [-122.441642,37.755285],[-122.441647,37.755276],[-122.441659,37.755261],[-122.441711,37.755171],
                            [-122.441749,37.755103],[-122.441766,37.755069],[-122.441799,37.754992],[-122.441886,37.754727],
                            [-122.441895,37.754698],[-122.441911,37.754673],[-122.441927,37.754635],[-122.441959,37.754573],
                            [-122.441985,37.754527],[-122.442013,37.754484],[-122.442077,37.754397],[-122.442418,37.753949],
                            [-122.442458,37.753898],[-122.442542,37.753769],[-122.44255,37.753759],[-122.442561,37.753747],
                            [-122.442608,37.753655],[-122.442621,37.753624],[-122.442643,37.753553],[-122.442651,37.753511],
                            [-122.442727,37.753216],[-122.442773,37.753078],[-122.442785,37.753054],[-122.442808,37.753015],
                            [-122.442865,37.752951],[-122.442886,37.752922],[-122.442911,37.752882],[-122.442933,37.752834],
                            [-122.442947,37.75279],[-122.442962,37.752736],[-122.442969,37.752573],[-122.442966,37.752526],
                            [-122.442958,37.75248],[-122.442951,37.75245],[-122.442989,37.752359],[-122.443027,37.752266],
                            [-122.443032,37.752091],[-122.443138,37.751647],[-122.443145,37.751617],[-122.443156,37.751574],
                            [-122.443233,37.751321],[-122.443309,37.751074],[-122.443409,37.750743],[-122.443511,37.75041],
                            [-122.443589,37.750158],[-122.443609,37.750076],[-122.443657,37.749932],[-122.443685,37.749785],
                            [-122.443679,37.749757],[-122.443667,37.749682],[-122.443663,37.749653],[-122.443663,37.749602],
                            [-122.443664,37.74954],[-122.443664,37.749533],[-122.44368,37.749491],[-122.443691,37.749462],
                            [-122.443717,37.749406],[-122.44376,37.749326],[-122.443788,37.74928],[-122.443819,37.749233],
                            [-122.44386,37.749179],[-122.443922,37.749106],[-122.444116,37.748842],[-122.444197,37.748732],
                            [-122.444235,37.748683],[-122.44427,37.748632],[-122.444289,37.748598],[-122.444314,37.748547],
                            [-122.444339,37.748487],[-122.444353,37.748438],[-122.444367,37.748376],[-122.444376,37.748302],
                            [-122.444377,37.748255],[-122.444376,37.74822],[-122.444372,37.748181],[-122.444366,37.748133],
                            [-122.444309,37.747883],[-122.444288,37.747786],[-122.444273,37.74769],[-122.444271,37.747651],
                            [-122.444273,37.747625],[-122.444278,37.747581],[-122.444286,37.747546],[-122.444305,37.747486],
                            [-122.444327,37.747443],[-122.444345,37.747411],[-122.444379,37.747364],[-122.44442,37.747318],
                            [-122.444468,37.747276],[-122.444527,37.747234],[-122.444581,37.747204],[-122.444594,37.747197],
                            [-122.444652,37.747172],[-122.444698,37.747156],[-122.444747,37.747143],[-122.444868,37.747103],
                            [-122.445427,37.747023],[-122.445735,37.746976],[-122.446273,37.746897],[-122.4466,37.746849],
                            [-122.446635,37.746849],[-122.446662,37.746851],[-122.446952,37.746886],[-122.447081,37.746901],
                            [-122.447211,37.746916],[-122.447297,37.746934],[-122.447361,37.746945],[-122.447438,37.746955],
                            [-122.447512,37.746961],[-122.447551,37.746963],[-122.447591,37.746964],[-122.447718,37.74696],
                            [-122.448016,37.746899],[-122.448116,37.746866],[-122.448151,37.746851],[-122.448197,37.746829],
                            [-122.448267,37.746788],[-122.448525,37.746652],[-122.448564,37.746656],[-122.448591,37.746656],
                            [-122.448619,37.746652],[-122.448658,37.746643],[-122.448686,37.746632],[-122.448713,37.746617],
                            [-122.448748,37.746589],[-122.448771,37.746557],[-122.448781,37.746535],[-122.44879,37.746504],
                            [-122.448878,37.746448],[-122.449032,37.746361],[-122.449152,37.746304],[-122.449217,37.746276],
                            [-122.449337,37.746231],[-122.449427,37.746202],[-122.449506,37.746178],[-122.449588,37.746157],
                            [-122.449655,37.746142],[-122.449826,37.746109],[-122.450312,37.746057],[-122.450493,37.746033],
                            [-122.45065,37.746009],[-122.450863,37.745982],[-122.451224,37.745938],[-122.451643,37.745735],
                            [-122.451659,37.745728],[-122.451759,37.745692],[-122.451815,37.745671],[-122.451993,37.745579],
                            [-122.452186,37.745467],[-122.45229,37.745417],[-122.452375,37.745374],[-122.452412,37.745353],[-122.452527,37.745289],[-122.453431,37.744749],[-122.453465,37.74473],[-122.453602,37.744669],[-122.453715,37.74462],[-122.453761,37.744589],[-122.453939,37.744467],[-122.454056,37.744384],[-122.454208,37.744272],[-122.454382,37.74414],[-122.454611,37.743959],[-122.454684,37.743898],[-122.454781,37.743817],[-122.454884,37.743724],[-122.455011,37.743604],[-122.455183,37.743429],[-122.455324,37.743273],
                            [-122.455401,37.743187],[-122.455451,37.743129],[-122.455518,37.743055],[-122.455519,37.743063],[-122.455529,37.743081],[-122.455869,37.743313],[-122.456119,37.743361],[-122.456168,37.743522],[-122.456338,37.743637],[-122.456422,37.743704],[-122.456493,37.743775],[-122.456565,37.743865],[-122.456612,37.743942],[-122.456652,37.744029],[-122.45673,37.744199],[-122.456944,37.744691],[-122.457041,37.744873],[-122.457098,37.74503],[-122.457137,37.745117],[-122.457189,37.745198],[-122.45729,37.745305],
                            [-122.457833,37.745636],[-122.457887,37.745673],[-122.458072,37.745826],[-122.458176,37.745931],
                            [-122.458299,37.746066],[-122.458457,37.74623],[-122.45848,37.746271],[-122.458675,37.746493],
                            [-122.458851,37.746642],[-122.458894,37.746678],[-122.459201,37.747027],[-122.459353,37.747147],[-122.459461,37.747233],[-122.458965,37.747673],
                            [-122.45891,37.747747],[-122.458889,37.747791],[-122.458895,37.747868],[-122.458906,37.747899],[-122.458924,37.747928],
                            [-122.459029,37.748039],[-122.45916,37.748164],[-122.459217,37.748343],[-122.459753,37.748867],[-122.460694,37.749775],
                            [-122.461241,37.75079],[-122.461541,37.751219],[-122.46164,37.751332],[-122.461689,37.751386],[-122.461718,37.75141],
                            [-122.46174,37.751436],[-122.46191,37.751583],[-122.46203,37.751679],[-122.462166,37.75177],[-122.462491,37.752099],[-122.462607,37.752208],
                            [-122.462858,37.752422],[-122.46301,37.752526],[-122.463218,37.752694],[-122.463351,37.752822],[-122.463475,37.752955],[-122.463625,37.753148],
                            [-122.463779,37.753394],[-122.463829,37.75349],[-122.46388,37.753642],[-122.463915,37.753761],[-122.463932,37.753878],
                            [-122.463933,37.754],[-122.463926,37.754113],[-122.463815,37.754588],[-122.463789,37.754698],[-122.463759,37.754782],[-122.463689,37.755042],
                            [-122.463678,37.75522],[-122.463777,37.756761],[-122.463903,37.758531],[-122.464032,37.760399],[-122.464162,37.762265],
                            [-122.464165,37.762303],[-122.464293,37.764123],[-122.464358,37.76506],[-122.464416,37.76588],[-122.464361,37.765944],
                            [-122.4643,37.766015],[-122.464321,37.766111],[-122.463228,37.766159],[-122.462163,37.766207],[-122.462145,37.766207],
                            [-122.461093,37.766253],[-122.460391,37.766286],[-122.460027,37.766305],[-122.459931,37.766349],[-122.459806,37.7664],
                            [-122.459021,37.767009],[-122.458775,37.767123],[-122.458639,37.7672],[-122.458882,37.767324],[-122.459063,37.767385],
                            [-122.45984,37.767515],[-122.460147,37.767513],[-122.460677,37.767449],[-122.46027,37.767803],[-122.46012,37.767912],
                            [-122.459796,37.76815],[-122.459657,37.768305],[-122.459594,37.768429],[-122.459544,37.768528],[-122.459472,37.768751],
                            [-122.459454,37.768899],[-122.459511,37.769009],[-122.460159,37.769429],[-122.460312,37.769595],[-122.460356,37.769763],
                            [-122.460352,37.76994],[-122.460334,37.770111],[-122.460283,37.770225],[-122.460116,37.770389],[-122.460107,37.770398],
                            [-122.460102,37.770403],[-122.459902,37.770446],[-122.459754,37.770517],[-122.459549,37.770646],[-122.459446,37.770766],
                            [-122.459335,37.770931],[-122.459263,37.771098],[-122.45922,37.771196],[-122.459188,37.771271],[-122.459173,37.771306],
                            [-122.460339,37.771484],[-122.461012,37.771587],[-122.461173,37.771611],[-122.461243,37.771624],[-122.462041,37.771767],
                            [-122.461952,37.77194],[-122.461853,37.772021],[-122.461508,37.772169],[-122.461387,37.77225],[-122.461244,37.772389],
                            [-122.461113,37.77258],[-122.461,37.772772],[-122.460854,37.772897],[-122.460661,37.772975],[-122.460439,37.773014],
                            [-122.459095,37.773246],[-122.458769,37.773555],[-122.45858,37.773764],[-122.458508,37.773845],[-122.458434,37.773974],
                            [-122.458391,37.774165],[-122.458383,37.7743],[-122.458373,37.774308],[-122.458205,37.774404],[-122.457326,37.774516],
                            [-122.456302,37.774648],[-122.45527,37.774779],[-122.454676,37.774854],[-122.454652,37.774857],[-122.453043,37.775062],
                            [-122.452836,37.775086],[-122.451468,37.775246],[-122.451415,37.775252],[-122.451395,37.775255],[-122.451372,37.775258],
                            [-122.449726,37.77548],[-122.449312,37.775535],[-122.448868,37.775591],[-122.448168,37.775682],
                            [-122.447462,37.77577],[-122.44665,37.775876]]]]
                    }
                }
            },
            'layout': {},
            'paint': {
                'fill-color': '#088',
                'fill-opacity': 0.8
            }
        });

        //add Day of Week layer
        beforemap.addLayer({
            'id': 'Weekday vs. Weekend',
            'type': 'circle',
            'source': {
                type: 'vector',
                url: 'mapbox://elmiracle.36uqjrui'
            },
            'source-layer': 'crime-6v0rnn',
            'layout': {
                'visibility': 'none'
            },
            'paint': {
                // make circles larger as the user zooms from z12 to z22
                'circle-radius': {
                    'base': 3,
                    'stops': [[12, 3.5], [22, 250]]
                },
                'circle-color': {
                    property: 'DayOfWeek',
                    type: 'categorical',
                    stops: [
                        ['Monday', '#3bb2d0'],
                        ['Tuesday', '#3bb2d0'],
                        ['Wednesday', '#3bb2d0'],
                        ['Thursday', '#3bb2d0'],
                        ['Friday', '#3bb2d0'],
                        ['Saturday', '#ff8c00'],
                        ['Sunday','#ff8c00']]
                }
            }
        });

        //add crime category layer
        beforemap.addLayer({
            'id': 'Crime Category',
            'type': 'circle',
            'source': {
                type: 'vector',
                url: 'mapbox://elmiracle.36uqjrui'
            },
            'source-layer': 'crime-6v0rnn',
            'layout': {
                'visibility': 'none'
            },
            'paint': {
                // make circles larger as the user zooms from z12 to z22
                'circle-radius': {
                    'base': 2,
                    'stops': [[12, 2.5], [22, 200]]
                },
                'circle-color': {
                    property: 'Category',
                    type: 'categorical',
                    stops: [
                        ['ASSAULT', '#e2ffaf'],  //Yellow, Assault
                        ['BURGLARY','#c43235'],  //Red, Burglary
                        ['VANDALISM', '#0DD91C'], //Green,  Vandalism
                        ['LARCENY\/THEFT','#ff7fff']] //white, larceny theft
                }
            }
        });


        //define variables for the legend
        var layers = ["Week day", "Weekend", 'Assault', 'Burglary', 'Vandalism','Larceny/Theft', 'All others'];

        var colors = ['#3bb2d0', '#ff8c00', '#e2ffaf', '#c43235', '#0DD91C', '#FF7FFF', '#000000'];



        //add legend
        for (i = 0; i < layers.length; i++) {
            var layer = layers[i];
            var color = colors[i];
            var item = document.createElement('div');
            var key = document.createElement('span');
            key.className = 'legend-key';
            key.style.backgroundColor = color;

            var value = document.createElement('span');
            value.innerHTML = layer;
            item.appendChild(key);
            item.appendChild(value);
            legend.appendChild(item);
        }




        beforemap.on('mousemove', function (e) {
            document.getElementById('info').innerHTML =
                // e.point is the x, y coordinates of the mousemove event relative
                // to the top-left corner of the map
                JSON.stringify(e.point) + '<br />' +
                // e.lngLat is the longitude, latitude geographical position of the event
                JSON.stringify(e.lngLat);
        });

        // Create a popup, but don't add it to the map yet.
        var popup = new mapboxgl.Popup({
            closeButton: false,
            closeOnClick: false
        });


        //tooltip for filter 1
        beforemap.on('mouseenter', 'Weekday vs. Weekend', function(e) {
            // Change the cursor style as a UI indicator.
            beforemap.getCanvas().style.cursor = 'pointer';

            // Populate the popup and set its coordinates
            // based on the feature found.
            popup.setLngLat(e.features[0].geometry.coordinates)
                .setHTML(e.features[0].properties.Category + "<br />" + e.features[0].properties.DayOfWeek)
                .addTo(beforemap);
        });

        beforemap.on('mouseleave', 'Weekday vs. Weekend', function() {
            beforemap.getCanvas().style.cursor = '';
            popup.remove();
        });

        //tooltip for filter 2
        beforemap.on('mouseenter', 'Crime Category', function(e) {
            // Change the cursor style as a UI indicator.
            beforemap.getCanvas().style.cursor = 'pointer';

            // Populate the popup and set its coordinates
            // based on the feature found.
            popup.setLngLat(e.features[0].geometry.coordinates)
                .setHTML(e.features[0].properties.Category + "<br />" + e.features[0].properties.DayOfWeek)
                .addTo(beforemap);
        });

        beforemap.on('mouseleave', 'Crime Category', function() {
            beforemap.getCanvas().style.cursor = '';
            popup.remove();
        });

        //add fullscreen mode
        beforemap.addControl(new mapboxgl.FullscreenControl());

    });

    var toggleableLayerIds = [ 'Weekday vs. Weekend', 'Crime Category'];

    //add buttons
    for (var i = 0; i < toggleableLayerIds.length; i++) {
        var id = toggleableLayerIds[i];

        var link = document.createElement('a');
        link.href = '#';
        link.className = '';
        link.textContent = id;

        link.onclick = function (e) {
            var clickedLayer = this.textContent;
            e.preventDefault();
            e.stopPropagation();

            var visibility = beforemap.getLayoutProperty(clickedLayer, 'visibility');

            if (visibility === 'visible') {
                beforemap.setLayoutProperty(clickedLayer, 'visibility', 'none');
                this.className = '';
            } else {
                this.className = 'active';
                beforemap.setLayoutProperty(clickedLayer, 'visibility', 'visible');
            }
        };

        var layers = document.getElementById('menu');
        layers.appendChild(link);
    }

    var afterMap = new mapboxgl.Map({
        container: 'map2',
        style: 'mapbox://styles/mapbox/streets-v9',
        center: [-122.427489,37.767831],
        zoom: 11.38
    });


    afterMap.on('load', function() {

        afterMap.addLayer({
            'id': 'northern',
            'type': 'fill',
            'source': {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'geometry': {
                        "type":"MultiPolygon",
                        "coordinates":[[[[-122.44665,37.775876],
                            [-122.446825,37.776718],[-122.447014,37.777647],[-122.447207,37.778601],[-122.447484,37.78], [-122.447518,37.780132],[-122.447553,37.780283],
                            [-122.447699,37.781039],[-122.447712,37.781118],[-122.447745,37.781279],[-122.447762,37.781365],
                            [-122.448049,37.78237],[-122.448044,37.782377], [-122.447194,37.782659],[-122.446008,37.782807],
                            [-122.445875,37.782746],[-122.445742,37.782684], [-122.444473,37.782848],[-122.442826,37.783056], [-122.441179,37.783267],[-122.439563,37.783474],
                            [-122.439468,37.783485],[-122.439023,37.783543], [-122.43886,37.78359],[-122.438737,37.783643],
                            [-122.438599,37.783709],[-122.438483,37.78376], [-122.438347,37.783809],[-122.438201,37.783853],
                            [-122.438093,37.783879],[-122.438004,37.783896], [-122.437888,37.783906],[-122.43777,37.783915],
                            [-122.435544,37.7842],[-122.434777,37.784333], [-122.434715,37.784128],[-122.434613,37.783786],
                            [-122.434466,37.783058],[-122.434298,37.782229], [-122.434261,37.782043],[-122.434109,37.781297],
                            [-122.434072,37.78111],[-122.433921,37.780365],[-122.433902,37.780272],[-122.433883,37.780178],
                            [-122.433733,37.779434],[-122.433695,37.779246],[-122.433543,37.778501], [-122.433505,37.778313],[-122.433355,37.777569],[-122.433336,37.777475],
                            [-122.433318,37.777382],[-122.433145,37.776534],[-122.432978,37.775704],[-122.43296,37.775609],[-122.432942,37.775517],[-122.432772,37.774675],
                            [-122.432754,37.774583],[-122.432604,37.773838],[-122.432416,37.772908], [-122.432398,37.772813],[-122.432379,37.77272],[-122.432229,37.771974],
                            [-122.432041,37.771044],[-122.432022,37.77095],[-122.432002,37.770855],[-122.431929,37.770491],[-122.431834,37.77002],[-122.431713,37.769414], [-122.431568,37.769307],[-122.431486,37.769211],[-122.431333,37.767602],
                            [-122.431187,37.766073],[-122.43127,37.765887],[-122.432985,37.764537], [-122.433252,37.764337],[-122.433443,37.764179],[-122.433537,37.7641],
                            [-122.434952,37.762981],[-122.435034,37.762915],[-122.435203,37.762857], [-122.435338,37.762819],[-122.435539,37.762733],[-122.435778,37.762629],
                            [-122.436029,37.762521],[-122.436355,37.762217],[-122.436408,37.762195], [-122.43647,37.762174],[-122.436529,37.762157],[-122.436601,37.76214],
                            [-122.436887,37.762088],[-122.437201,37.76203],[-122.437306,37.762013], [-122.437419,37.761995],[-122.438272,37.761847],[-122.438374,37.76183],[-122.438477,37.761813],
                            [-122.438591,37.761793],[-122.438705,37.761769],[-122.438797,37.761749],[-122.438976,37.761704],
                            [-122.439096,37.761669],[-122.439117,37.761662],[-122.439176,37.761643],[-122.439325,37.761593],
                            [-122.439426,37.761556],[-122.439527,37.76152],[-122.439623,37.76148],[-122.439703,37.761444],
                            [-122.439847,37.761376],[-122.439977,37.761307],[-122.440076,37.761257],[-122.440176,37.761206],
                            [-122.440541,37.761179],[-122.440906,37.761178],[-122.440994,37.761177],[-122.441793,37.761175],
                            [-122.442249,37.761175],[-122.442356,37.761175],[-122.442446,37.761174],[-122.442734,37.760983],
                            [-122.442976,37.760865],[-122.443506,37.760642],[-122.444031,37.760304],[-122.444235,37.760173],
                            [-122.444388,37.760075],[-122.444566,37.75996],[-122.44472,37.75986],[-122.444814,37.759799],
                            [-122.444856,37.759765],[-122.444885,37.759738],[-122.444918,37.759703],[-122.444946,37.75967],
                            [-122.444965,37.759642],[-122.444983,37.759611],[-122.445016,37.759539],[-122.445026,37.759509],
                            [-122.445035,37.759471],[-122.445066,37.759383],[-122.445075,37.759339],[-122.445081,37.759301],
                            [-122.445085,37.759244],[-122.445087,37.7592],[-122.445085,37.759157],[-122.44508,37.759114],
                            [-122.445061,37.759019],[-122.445047,37.758968],[-122.445023,37.758906],[-122.445009,37.758875],
                            [-122.444973,37.758809],[-122.444919,37.758729],[-122.444865,37.758664],[-122.444864,37.758601],
                            [-122.444672,37.758461],[-122.44459,37.758272],[-122.444558,37.758263],[-122.444276,37.75821],
                            [-122.443996,37.758076],[-122.443687,37.757938],[-122.44345,37.757762],[-122.443255,37.757545],
                            [-122.443195,37.757488],[-122.443038,37.757339],[-122.443011,37.757305],[-122.442875,37.757139],
                            [-122.442755,37.757001],[-122.442705,37.756946],[-122.442648,37.756865],[-122.442625,37.756832],
                            [-122.442584,37.756787],[-122.442552,37.756755],[-122.442526,37.756733],[-122.442489,37.756703],
                            [-122.442449,37.756676],[-122.442378,37.756634],[-122.442312,37.756603],[-122.442273,37.756575],
                            [-122.442234,37.756546],[-122.441457,37.756322],[-122.441452,37.756325],[-122.441421,37.756317],
                            [-122.441386,37.756303],[-122.441359,37.756286],[-122.441356,37.756279],[-122.441321,37.756202],
                            [-122.441276,37.756097],[-122.441325,37.755881],[-122.441449,37.75559],[-122.44147,37.75557],
                            [-122.44151,37.755529],[-122.441571,37.755449],[-122.441593,37.755411],[-122.441609,37.755381],
                            [-122.441624,37.755346],[-122.441637,37.755313],[-122.441637,37.755306],[-122.441639,37.755294],
                            [-122.441642,37.755285],[-122.441647,37.755276],[-122.441659,37.755261],[-122.441711,37.755171],
                            [-122.441749,37.755103],[-122.441766,37.755069],[-122.441799,37.754992],[-122.441886,37.754727],
                            [-122.441895,37.754698],[-122.441911,37.754673],[-122.441927,37.754635],[-122.441959,37.754573],
                            [-122.441985,37.754527],[-122.442013,37.754484],[-122.442077,37.754397],[-122.442418,37.753949],
                            [-122.442458,37.753898],[-122.442542,37.753769],[-122.44255,37.753759],[-122.442561,37.753747],
                            [-122.442608,37.753655],[-122.442621,37.753624],[-122.442643,37.753553],[-122.442651,37.753511],
                            [-122.442727,37.753216],[-122.442773,37.753078],[-122.442785,37.753054],[-122.442808,37.753015],
                            [-122.442865,37.752951],[-122.442886,37.752922],[-122.442911,37.752882],[-122.442933,37.752834],
                            [-122.442947,37.75279],[-122.442962,37.752736],[-122.442969,37.752573],[-122.442966,37.752526],
                            [-122.442958,37.75248],[-122.442951,37.75245],[-122.442989,37.752359],[-122.443027,37.752266],
                            [-122.443032,37.752091],[-122.443138,37.751647],[-122.443145,37.751617],[-122.443156,37.751574],
                            [-122.443233,37.751321],[-122.443309,37.751074],[-122.443409,37.750743],[-122.443511,37.75041],
                            [-122.443589,37.750158],[-122.443609,37.750076],[-122.443657,37.749932],[-122.443685,37.749785],
                            [-122.443679,37.749757],[-122.443667,37.749682],[-122.443663,37.749653],[-122.443663,37.749602],
                            [-122.443664,37.74954],[-122.443664,37.749533],[-122.44368,37.749491],[-122.443691,37.749462],
                            [-122.443717,37.749406],[-122.44376,37.749326],[-122.443788,37.74928],[-122.443819,37.749233],
                            [-122.44386,37.749179],[-122.443922,37.749106],[-122.444116,37.748842],[-122.444197,37.748732],
                            [-122.444235,37.748683],[-122.44427,37.748632],[-122.444289,37.748598],[-122.444314,37.748547],
                            [-122.444339,37.748487],[-122.444353,37.748438],[-122.444367,37.748376],[-122.444376,37.748302],
                            [-122.444377,37.748255],[-122.444376,37.74822],[-122.444372,37.748181],[-122.444366,37.748133],
                            [-122.444309,37.747883],[-122.444288,37.747786],[-122.444273,37.74769],[-122.444271,37.747651],
                            [-122.444273,37.747625],[-122.444278,37.747581],[-122.444286,37.747546],[-122.444305,37.747486],
                            [-122.444327,37.747443],[-122.444345,37.747411],[-122.444379,37.747364],[-122.44442,37.747318],
                            [-122.444468,37.747276],[-122.444527,37.747234],[-122.444581,37.747204],[-122.444594,37.747197],
                            [-122.444652,37.747172],[-122.444698,37.747156],[-122.444747,37.747143],[-122.444868,37.747103],
                            [-122.445427,37.747023],[-122.445735,37.746976],[-122.446273,37.746897],[-122.4466,37.746849],
                            [-122.446635,37.746849],[-122.446662,37.746851],[-122.446952,37.746886],[-122.447081,37.746901],
                            [-122.447211,37.746916],[-122.447297,37.746934],[-122.447361,37.746945],[-122.447438,37.746955],
                            [-122.447512,37.746961],[-122.447551,37.746963],[-122.447591,37.746964],[-122.447718,37.74696],
                            [-122.448016,37.746899],[-122.448116,37.746866],[-122.448151,37.746851],[-122.448197,37.746829],
                            [-122.448267,37.746788],[-122.448525,37.746652],[-122.448564,37.746656],[-122.448591,37.746656],
                            [-122.448619,37.746652],[-122.448658,37.746643],[-122.448686,37.746632],[-122.448713,37.746617],
                            [-122.448748,37.746589],[-122.448771,37.746557],[-122.448781,37.746535],[-122.44879,37.746504],
                            [-122.448878,37.746448],[-122.449032,37.746361],[-122.449152,37.746304],[-122.449217,37.746276],
                            [-122.449337,37.746231],[-122.449427,37.746202],[-122.449506,37.746178],[-122.449588,37.746157],
                            [-122.449655,37.746142],[-122.449826,37.746109],[-122.450312,37.746057],[-122.450493,37.746033],
                            [-122.45065,37.746009],[-122.450863,37.745982],[-122.451224,37.745938],[-122.451643,37.745735],
                            [-122.451659,37.745728],[-122.451759,37.745692],[-122.451815,37.745671],[-122.451993,37.745579],
                            [-122.452186,37.745467],[-122.45229,37.745417],[-122.452375,37.745374],[-122.452412,37.745353],[-122.452527,37.745289],[-122.453431,37.744749],[-122.453465,37.74473],[-122.453602,37.744669],[-122.453715,37.74462],[-122.453761,37.744589],[-122.453939,37.744467],[-122.454056,37.744384],[-122.454208,37.744272],[-122.454382,37.74414],[-122.454611,37.743959],[-122.454684,37.743898],[-122.454781,37.743817],[-122.454884,37.743724],[-122.455011,37.743604],[-122.455183,37.743429],[-122.455324,37.743273],
                            [-122.455401,37.743187],[-122.455451,37.743129],[-122.455518,37.743055],[-122.455519,37.743063],[-122.455529,37.743081],[-122.455869,37.743313],[-122.456119,37.743361],[-122.456168,37.743522],[-122.456338,37.743637],[-122.456422,37.743704],[-122.456493,37.743775],[-122.456565,37.743865],[-122.456612,37.743942],[-122.456652,37.744029],[-122.45673,37.744199],[-122.456944,37.744691],[-122.457041,37.744873],[-122.457098,37.74503],[-122.457137,37.745117],[-122.457189,37.745198],[-122.45729,37.745305],
                            [-122.457833,37.745636],[-122.457887,37.745673],[-122.458072,37.745826],[-122.458176,37.745931],
                            [-122.458299,37.746066],[-122.458457,37.74623],[-122.45848,37.746271],[-122.458675,37.746493],
                            [-122.458851,37.746642],[-122.458894,37.746678],[-122.459201,37.747027],[-122.459353,37.747147],[-122.459461,37.747233],[-122.458965,37.747673],
                            [-122.45891,37.747747],[-122.458889,37.747791],[-122.458895,37.747868],[-122.458906,37.747899],[-122.458924,37.747928],
                            [-122.459029,37.748039],[-122.45916,37.748164],[-122.459217,37.748343],[-122.459753,37.748867],[-122.460694,37.749775],
                            [-122.461241,37.75079],[-122.461541,37.751219],[-122.46164,37.751332],[-122.461689,37.751386],[-122.461718,37.75141],
                            [-122.46174,37.751436],[-122.46191,37.751583],[-122.46203,37.751679],[-122.462166,37.75177],[-122.462491,37.752099],[-122.462607,37.752208],
                            [-122.462858,37.752422],[-122.46301,37.752526],[-122.463218,37.752694],[-122.463351,37.752822],[-122.463475,37.752955],[-122.463625,37.753148],
                            [-122.463779,37.753394],[-122.463829,37.75349],[-122.46388,37.753642],[-122.463915,37.753761],[-122.463932,37.753878],
                            [-122.463933,37.754],[-122.463926,37.754113],[-122.463815,37.754588],[-122.463789,37.754698],[-122.463759,37.754782],[-122.463689,37.755042],
                            [-122.463678,37.75522],[-122.463777,37.756761],[-122.463903,37.758531],[-122.464032,37.760399],[-122.464162,37.762265],
                            [-122.464165,37.762303],[-122.464293,37.764123],[-122.464358,37.76506],[-122.464416,37.76588],[-122.464361,37.765944],
                            [-122.4643,37.766015],[-122.464321,37.766111],[-122.463228,37.766159],[-122.462163,37.766207],[-122.462145,37.766207],
                            [-122.461093,37.766253],[-122.460391,37.766286],[-122.460027,37.766305],[-122.459931,37.766349],[-122.459806,37.7664],
                            [-122.459021,37.767009],[-122.458775,37.767123],[-122.458639,37.7672],[-122.458882,37.767324],[-122.459063,37.767385],
                            [-122.45984,37.767515],[-122.460147,37.767513],[-122.460677,37.767449],[-122.46027,37.767803],[-122.46012,37.767912],
                            [-122.459796,37.76815],[-122.459657,37.768305],[-122.459594,37.768429],[-122.459544,37.768528],[-122.459472,37.768751],
                            [-122.459454,37.768899],[-122.459511,37.769009],[-122.460159,37.769429],[-122.460312,37.769595],[-122.460356,37.769763],
                            [-122.460352,37.76994],[-122.460334,37.770111],[-122.460283,37.770225],[-122.460116,37.770389],[-122.460107,37.770398],
                            [-122.460102,37.770403],[-122.459902,37.770446],[-122.459754,37.770517],[-122.459549,37.770646],[-122.459446,37.770766],
                            [-122.459335,37.770931],[-122.459263,37.771098],[-122.45922,37.771196],[-122.459188,37.771271],[-122.459173,37.771306],
                            [-122.460339,37.771484],[-122.461012,37.771587],[-122.461173,37.771611],[-122.461243,37.771624],[-122.462041,37.771767],
                            [-122.461952,37.77194],[-122.461853,37.772021],[-122.461508,37.772169],[-122.461387,37.77225],[-122.461244,37.772389],
                            [-122.461113,37.77258],[-122.461,37.772772],[-122.460854,37.772897],[-122.460661,37.772975],[-122.460439,37.773014],
                            [-122.459095,37.773246],[-122.458769,37.773555],[-122.45858,37.773764],[-122.458508,37.773845],[-122.458434,37.773974],
                            [-122.458391,37.774165],[-122.458383,37.7743],[-122.458373,37.774308],[-122.458205,37.774404],[-122.457326,37.774516],
                            [-122.456302,37.774648],[-122.45527,37.774779],[-122.454676,37.774854],[-122.454652,37.774857],[-122.453043,37.775062],
                            [-122.452836,37.775086],[-122.451468,37.775246],[-122.451415,37.775252],[-122.451395,37.775255],[-122.451372,37.775258],
                            [-122.449726,37.77548],[-122.449312,37.775535],[-122.448868,37.775591],[-122.448168,37.775682],
                            [-122.447462,37.77577],[-122.44665,37.775876]]]]
                    }
                }
            },
            'layout': {},
            'paint': {
                'fill-color': '#088',
                'fill-opacity': 0.8
            }
        });

        afterMap.addLayer({
            'id': 'Resolution of the Crime',
            'type': 'circle',
            'source': {
                type: 'vector',
                url: 'mapbox://elmiracle.36uqjrui'
            },
            'source-layer': 'crime-6v0rnn',
            'paint': {
                // make circles larger as the user zooms from z12 to z22
                'circle-radius': {
                    'base': 4,
                    'stops': [[12, 4.5], [22, 250]]
                },
                'circle-color': {
                    property: 'Resolution',
                    type: 'categorical',
                    stops: [
                        ['NONE', '#ff0044'],
                        ["PSYCHOPATHIC CASE",'#0011e1']]
                }
            }
        });

        var layers2 = ["No resolution", "Success", "Psychopathic Case"];

        var colors2 = ["#ff0044", '#000000', '#0011E1'];

        //add fullscreen mode
        afterMap.addControl(new mapboxgl.FullscreenControl());

        //add legend
        for (i = 0; i < layers2.length; i++) {
            var layer = layers2[i];
            var color = colors2[i];
            var item = document.createElement('div');
            var key = document.createElement('span');
            key.className = 'legend-key';
            key.style.backgroundColor = color;

            var value = document.createElement('span');
            value.innerHTML = layer;
            item.appendChild(key);
            item.appendChild(value);
            legend2.appendChild(item);
        }

        afterMap.on('mousemove', function (e) {
            document.getElementById('info').innerHTML =
                // e.point is the x, y coordinates of the mousemove event relative
                // to the top-left corner of the map
                JSON.stringify(e.point) + '<br />' +
                // e.lngLat is the longitude, latitude geographical position of the event
                JSON.stringify(e.lngLat);
        });});


</script>


</body>
</html>
